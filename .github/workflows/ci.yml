name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  validate-bash:
    name: Validate Bash Script
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Check syntax
        run: bash -n install.sh
      
      - name: ShellCheck
        uses: ludeeus/action-shellcheck@master
        with:
          scandir: '.'
          severity: warning

  validate-powershell:
    name: Validate PowerShell Script
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Check syntax
        shell: pwsh
        run: |
          $errors = $null
          $null = [System.Management.Automation.Language.Parser]::ParseFile(
            "$PWD/install.ps1",
            [ref]$null,
            [ref]$errors
          )
          if ($errors) {
            $errors | ForEach-Object { Write-Error $_.ToString() }
            exit 1
          }
          Write-Host "PowerShell syntax OK" -ForegroundColor Green
